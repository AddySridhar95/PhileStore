



            case R.id.action_paste:

                Log.d("action_paste", clipboard.size() + "");

                // TODO: bug. pasting multiple items ....
                for (int i = 0; i < clipboard.size(); i++) {

                    String parentPath = path;
                    if (!parentPath.endsWith(File.separator)) {
                        parentPath = parentPath + File.separator;
                    }

                    File clipboardFile = new File(clipboard.get(i).getFilePath() + clipboard.get(i).getFileName());
                    File targetFile = new File(parentPath + clipboard.get(i).getFileName());
                    if (clipboardOperation == "move") {

                        boolean moveStatus = renameFile(clipboardFile, targetFile);
                        if (moveStatus) {
                            prepareFileItemsFromPath();
                            restartListFragment();
                        } else {
                            Toast toast = Toast.makeText(getApplicationContext(), "Move operation failed", Toast.LENGTH_SHORT);
                            toast.show();
                        }
                    } else {
                        boolean copyStatus = copyFilesOrDirectories(clipboardFile, targetFile);
                        if (copyStatus) {
                            // prepareFileItemsFromPath();
                            // restartListFragment();
                        } else {
                            Toast toast = Toast.makeText(getApplicationContext(), "Copy operation failed", Toast.LENGTH_SHORT);
                            toast.show();
                        }
                    }
                    clipboard.clear();
                    invalidateOptionsMenu();
                }
                return true;





                        private boolean copyFilesOrDirectories(File from, File to) {
                            if (!from.exists()) {
                                return false;
                            }

                            if (from.isDirectory()) {
                                if (!to.exists()) {
                                    to.mkdir();
                                }

                                // TODO: test (filter)
                                String[] files = from.list(filter);
                                // Log.d("copyFilesOrDirectories", files.length + "");
                                for(int i = 0; i < files.length; i++) {

                                    // parentPath is the path of the directory the file in question is in.
                                    String parentPath = from.getAbsolutePath();
                                    if (!parentPath.endsWith(File.separator)) {
                                        parentPath = parentPath + File.separator;
                                    }

                                    // TODO error handling
                                    boolean a = copyFilesOrDirectories(new File(parentPath + files[i]), new File(to.getAbsolutePath(), files[i]));
                                }

                                Log.d("copyFilesOrDirectories", "directory!!!!");
                                return true;
                            } else {
                                Log.d("copyFilesOrDirectories", "file!!!!");
                                try {
                                    copy(from, to);
                                    return true;
                                } catch (IOException ex) {

                                }
                                return false;
                            }
                        }
